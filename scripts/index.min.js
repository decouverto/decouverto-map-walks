!function i(l,a,s){function c(t,e){if(!a[t]){if(!l[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var n=a[t]={exports:{}};l[t][0].call(n.exports,function(e){return c(l[t][1][e]||e)},n,n.exports,i,l,a,s)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,r){t.exports=function(t,r){var o=new XMLHttpRequest;o.open("GET",t),o.onload=function(){if(200===o.status)r(null,JSON.parse(o.responseText));else{var e=new Error("Cannot get "+t);r(e)}},o.send()}},{}],2:[function(e,t,r){var s=e("./get-json.js"),c=document.getElementById("popup");s("https://decouverto.fr/walks/first-points.json",function(e,t){if(e)return console.error(e);var a=new ol.source.Vector,r=new ol.source.Vector,n=new ol.source.Vector,o=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000",width:5})});var i=new ol.Map({target:"map",layers:[new ol.layer.Tile({source:new ol.source.OSM}),new ol.layer.Vector({source:n,style:o}),new ol.layer.Vector({source:r}),new ol.layer.Vector({source:a})],view:new ol.View({center:[0,0],zoom:0})}),l=new ol.Overlay({element:c,positioning:"bottom-center",stopEvent:!1,offset:[0,-50]});i.addOverlay(l),i.getViewport().addEventListener("dblclick",function(e){var t=i.getEventCoordinate(e);r.clear(),r.addFeature(new ol.Feature(new ol.geom.Circle(t,16e3)))}),i.on("click",function(e){var t=i.forEachFeatureAtPixel(e.pixel,function(e){return e});if(n.clear(),t&&null!=t.get("title")){var r=t.getGeometry().getCoordinates();l.setPosition(r),c.innerHTML='<div class="popover fade top in" style="display: block;" role="tooltip"><div class="arrow"></div><h3 class="popover-title">Balade</h3><div class="popover-content"></div></div>',c.querySelector(".popover-content").innerHTML='<a target="_blank" href="https://decouverto.fr/rando/'+t.get("id")+'">'+t.get("title")+"</a>",popover=c.querySelector(".popover"),popover.style.display="block",popover.style.position="relative",i.getView().setCenter(ol.proj.transform([t.get("lon"),t.get("lat")],"EPSG:4326","EPSG:3857")),s("https://decouverto.fr/walks/"+t.get("id")+"/index.json",function(e,t){if(e)return console.error(e);var r=[];t.itinerary.forEach(function(e){r.push([e.longitude,e.latitude])}),r.push([t.itinerary[0].longitude,t.itinerary[0].latitude]);var o=new ol.geom.LineString(r);o.transform("EPSG:4326","EPSG:3857"),n.addFeature(new ol.Feature({geometry:o,name:"Line"})),i.getView().fit(n.getExtent(),{size:i.getSize(),maxZoom:i.getView().getZoom()})})}}),i.on("pointermove",function(e){if(e.dragging)return popover=c.querySelector(".popover"),void(popover.style.display="none");var t=this.forEachFeatureAtPixel(e.pixel,function(e,t){return!0});this.getTargetElement().style.cursor=t?"pointer":""}),i.getView().setZoom(8),barycentre={longitude:0,latitude:0,n:0},t.forEach(function(e){var t,r,o,n,i,l;t=e.lng,r=e.lat,o=e.title,n=e.id,i=e.dist,(l=new ol.Feature({geometry:new ol.geom.Point(ol.proj.transform([t,r],"EPSG:4326","EPSG:3857")),title:o+" ("+i+" km)",id:n,lon:t,lat:r})).setStyle(new ol.style.Style({image:new ol.style.Icon({anchor:[.5,35],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:.75,src:"/images/marker_icon.png"})})),a.addFeature(l),barycentre.longitude+=e.lng,barycentre.latitude+=e.lat,barycentre.n+=1}),barycentre.longitude/=barycentre.n,barycentre.latitude/=barycentre.n,i.getView().setCenter(ol.proj.transform([barycentre.longitude,barycentre.latitude],"EPSG:4326","EPSG:3857"))})},{"./get-json.js":1}]},{},[2]);