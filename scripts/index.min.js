!function i(l,a,c){function s(t,e){if(!a[t]){if(!l[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(u)return u(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var n=a[t]={exports:{}};l[t][0].call(n.exports,function(e){return s(l[t][1][e]||e)},n,n.exports,i,l,a,c)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)s(c[e]);return s}({1:[function(e,t,o){t.exports=function(t,o){var r=new XMLHttpRequest;r.open("GET",t),r.onload=function(){if(200===r.status)o(null,JSON.parse(r.responseText));else{var e=new Error("Cannot get "+t);o(e)}},r.send()}},{}],2:[function(e,t,o){var c=e("./get-json.js"),s=document.getElementById("popup");c("https://decouverto.fr/walks/first-points.json",function(e,t){if(e)return console.error(e);var a=new ol.source.Vector,o=new ol.source.Vector,n=new ol.source.Vector,r=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000",width:5})});var i=new ol.Map({target:"map",layers:[new ol.layer.Tile({source:new ol.source.OSM}),new ol.layer.Vector({source:n,style:r}),new ol.layer.Vector({source:o}),new ol.layer.Vector({source:a})],view:new ol.View({center:[0,0],zoom:0})}),l=new ol.Overlay({element:s,positioning:"bottom-center",stopEvent:!1,offset:[0,-50]});i.addOverlay(l),i.getViewport().addEventListener("dblclick",function(e){var t=i.getEventCoordinate(e);o.clear(),o.addFeature(new ol.Feature(new ol.geom.Circle(t,16e3)))}),i.on("click",function(e){var t=i.forEachFeatureAtPixel(e.pixel,function(e){return e});if(n.clear(),t&&null!=t.get("title")){var o=t.getGeometry().getCoordinates();l.setPosition(o),s.innerHTML='<div class="popover fade top in" style="display: block;" role="tooltip"><div class="arrow"></div><h3 class="popover-title">Balade</h3><div class="popover-content"></div></div>',s.querySelector(".popover-content").innerHTML='<a target="_blank" href="https://decouverto.fr/rando/'+t.get("id")+'">'+t.get("title")+"</a>",popover=s.querySelector(".popover"),popover.style.display="block",popover.style.position="relative",i.getView().setCenter(ol.proj.transform([t.get("lon"),t.get("lat")],"EPSG:4326","EPSG:3857")),c("https://decouverto.fr/walks/"+t.get("id")+"/index.json",function(e,t){if(e)return console.error(e);var o=[];t.itinerary.forEach(function(e){o.push([e.longitude,e.latitude])}),o.push([t.itinerary[0].longitude,t.itinerary[0].latitude]);var r=new ol.geom.LineString(o);r.transform("EPSG:4326","EPSG:3857"),n.addFeature(new ol.Feature({geometry:r,name:"Line"})),i.getView().fit(n.getExtent(),{size:i.getSize(),maxZoom:i.getView().getZoom()})})}}),i.on("pointermove",function(e){if(e.dragging)return popover=s.querySelector(".popover"),void(popover.style.display="none");var t=this.forEachFeatureAtPixel(e.pixel,function(e,t){return!0});this.getTargetElement().style.cursor=t?"pointer":""}),i.getView().setZoom(8),barycentre={longitude:0,latitude:0,n:0},t.forEach(function(e){var t,o,r,n,i,l;t=e.coord.longitude,o=e.coord.latitude,r=e.title,n=e.id,i=e.dist,(l=new ol.Feature({geometry:new ol.geom.Point(ol.proj.transform([t,o],"EPSG:4326","EPSG:3857")),title:r+" ("+i+" km)",id:n,lon:t,lat:o})).setStyle(new ol.style.Style({image:new ol.style.Icon({anchor:[.5,35],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:.75,src:"/images/marker_icon.png"})})),a.addFeature(l),barycentre.longitude+=e.coord.longitude,barycentre.latitude+=e.coord.latitude,barycentre.n+=1}),barycentre.longitude/=barycentre.n,barycentre.latitude/=barycentre.n,i.getView().setCenter(ol.proj.transform([barycentre.longitude,barycentre.latitude],"EPSG:4326","EPSG:3857"))})},{"./get-json.js":1}]},{},[2]);